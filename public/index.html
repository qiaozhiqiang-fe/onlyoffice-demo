<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>ONLYOFFICE PPT 预览 Demo</title>
    <script src="http://localhost:8080/web-apps/apps/api/documents/api.js"></script>
  </head>
  <body>
    <h2>上传 PPT 文件并在线预览</h2>
    <input type="file" id="fileInput" accept=".ppt,.pptx" />
    <div id="viewer" style="width: 100%; height: 800px; margin-top: 20px;"></div>

    <script>
      const input = document.getElementById("fileInput");
      input.addEventListener("change", async () => {
        const file = input.files[0];
        const formData = new FormData();
        formData.append("ppt", file);
        const res = await fetch("http://localhost:3000/upload", {
          method: "POST",
          body: formData,
        });
        const config = await res.json();
        new DocsAPI.DocEditor("viewer", config);
      });
    </script>
  </body>
</html>
